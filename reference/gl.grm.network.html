<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Represents a genomic relationship matrix (GRM) as a network — gl.grm.network • dartR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Represents a genomic relationship matrix (GRM) as a network — gl.grm.network"><meta property="og:description" content="This script takes a G matrix generated by gl.grm and represents
the relationship among the specimens as a network diagram. In order to use
this script, a decision is required on a threshold for relatedness to be
represented as link in the network, and on the layout used to create the
diagram."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dartRTutorials.html">dartR Tutorials</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Represents a genomic relationship matrix (GRM) as a network</h1>
    
    <div class="hidden name"><code>gl.grm.network.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This script takes a G matrix generated by <code><a href="gl.grm.html">gl.grm</a></code> and represents
the relationship among the specimens as a network diagram. In order to use
this script, a decision is required on a threshold for relatedness to be
represented as link in the network, and on the layout used to create the
diagram.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.grm.network</span><span class="op">(</span></span>
<span>  <span class="va">G</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fr"</span>,</span>
<span>  node.size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  node.label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  node.label.size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  node.label.color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  link.color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link.size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  relatedness_factor <span class="op">=</span> <span class="fl">0.125</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Network based on a genomic relationship matrix"</span>,</span>
<span>  palette_discrete <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save2tmp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>G</dt>
<dd><p>A genomic relationship matrix (GRM) generated by
<code><a href="gl.grm.html">gl.grm</a></code> [required].</p></dd>


<dt>x</dt>
<dd><p>A genlight object from which the G matrix was generated [required].</p></dd>


<dt>method</dt>
<dd><p>One of 'fr', 'kk', 'gh' or 'mds' [default 'fr'].</p></dd>


<dt>node.size</dt>
<dd><p>Size of the symbols for the network nodes [default 8].</p></dd>


<dt>node.label</dt>
<dd><p>TRUE to display node labels [default TRUE].</p></dd>


<dt>node.label.size</dt>
<dd><p>Size of the node labels [default 3].</p></dd>


<dt>node.label.color</dt>
<dd><p>Color of the text of the node labels
[default 'black'].</p></dd>


<dt>link.color</dt>
<dd><p>Color palette for links [default NULL].</p></dd>


<dt>link.size</dt>
<dd><p>Size of the links [default 2].</p></dd>


<dt>relatedness_factor</dt>
<dd><p>Factor of relatedness [default 0.125].</p></dd>


<dt>title</dt>
<dd><p>Title for the plot
[default 'Network based on genomic relationship matrix'].</p></dd>


<dt>palette_discrete</dt>
<dd><p>A discrete palette for the color of populations or a
list with as many colors as there are populations in the dataset
 [default NULL].</p></dd>


<dt>save2tmp</dt>
<dd><p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p></dd>


<dt>verbose</dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A network plot showing relatedness between individuals</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The gl.grm.network function takes a genomic relationship matrix (GRM) 
generated by the gl.grm function to represent the relationship among 
individuals in the dataset as a network diagram. To generate the GRM, the 
function gl.grm uses the function A.mat from package rrBLUP, which implements
 the approach developed by Endelman and Jannink (2012).</p> 
<p>The GRM is an estimate of the proportion of alleles that two individuals have
 in common. It is generated by estimating the covariance of the genotypes 
 between two individuals, i.e. how much genotypes in the two individuals
  correspond with each other. This covariance depends on the probability that
   alleles at a random locus are identical by state (IBS). Two alleles are 
   IBS if they represent the same allele. Two alleles are identical by 
   descent (IBD) if one is a physical copy of the other or if they are both 
   physical copies of the same ancestral allele. Note that IBD is complicated
    to determine. IBD implies IBS, but not conversely. However, as the number
     of SNPs in a dataset increases, the mean probability of IBS approaches 
     the mean probability of IBD.</p>     
<p>It follows that the off-diagonal elements of the GRM are two times the 
kinship coefficient, i.e. the probability that two alleles at a random locus
 drawn from two individuals are IBD. Additionally, the diagonal elements of
  the GRM are 1+f, where f is the inbreeding coefficient of each individual,
   i.e. the probability that the two alleles at a random locus are IBD.</p>   
<p>Choosing a meaningful threshold to represent the relationship between 
individuals is tricky because IBD is not an absolute state but is relative to
 a reference population for which there is generally little information so 
 that we can estimate the kinship of a pair of individuals only relative to 
 some other quantity. To deal with this, we can use the average inbreeding 
 coefficient of the diagonal elements as the reference value. For this, the 
 function subtracts 1 from the mean of the diagonal elements of the GRM. In a
  second step, the off-diagonal elements are divided by 2, and finally, the 
  mean of the diagonal elements is subtracted from each off-diagonal element 
  after dividing them by 2. This approach is similar to the one used by 
  Goudet et al. (2018).</p>  
<p>Below is a table modified from Speed &amp; Balding (2015) showing kinship values,
 and their confidence intervals (CI), for different relationships that could 
 be used to guide the choosing of the relatedness threshold in the function.</p>
<p>|Relationship|Kinship|95<!-- % CI| -->
|Identical twins/clones/same individual     | 0.5     |        -         |</p>
<p>|Sibling/Parent-Offspring                   | 0.25    |    (0.204, 0.296)|</p>
<p>|Half-sibling                               | 0.125   |    (0.092, 0.158)|</p>
<p>|First cousin                               | 0.062   |    (0.038, 0.089)|</p>
<p>|Half-cousin                                | 0.031   |    (0.012, 0.055)|</p>
<p>|Second cousin                              | 0.016   |    (0.004, 0.031)|</p>
<p>|Half-second cousin                         | 0.008   |    (0.001, 0.020)|</p>
<p>|Third cousin                               | 0.004   |    (0.000, 0.012)|</p>
<p>|Unrelated                                  | 0       |        -         |</p>
<p>Four layout options are implemented in this function:</p><ul><li><p>'fr' Fruchterman-Reingold layout  <a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html" class="external-link">layout_with_fr</a>
(package igraph)</p></li>
<li><p>'kk' Kamada-Kawai layout <a href="https://rdrr.io/pkg/igraph/man/layout_with_kk.html" class="external-link">layout_with_kk</a> (package igraph)</p></li>
<li><p>'gh' Graphopt layout <a href="https://rdrr.io/pkg/igraph/man/layout_with_graphopt.html" class="external-link">layout_with_graphopt</a>
(package igraph)</p></li>
<li><p>'mds' Multidimensional scaling layout <a href="https://rdrr.io/pkg/igraph/man/layout_with_mds.html" class="external-link">layout_with_mds</a>
(package igraph)</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Endelman, J. B. , Jannink, J.-L. (2012). Shrinkage estimation of the 
realized relationship matrix. G3: Genes, Genomics, Genetics 2, 1405.</p></li>
<li><p>Goudet, J., Kay, T., &amp; Weir, B. S. (2018). How to estimate kinship.
Molecular Ecology, 27(20), 4121-4135.</p></li>
<li><p>Speed, D., &amp; Balding, D. J. (2015). Relatedness in the post-genomic era: 
is it still useful?. Nature Reviews Genetics, 16(1), 33-44.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gl.grm.html">gl.grm</a></code></p>
<p>Other inbreeding functions: 
<code><a href="gl.grm.html">gl.grm</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Custodian: Arthur Georges -- Post to
<a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="va">possums.gl</span></span></span>
<span class="r-in"><span><span class="co"># filtering on call rate </span></span></span>
<span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.filter.callrate.html">gl.filter.callrate</a></span><span class="op">(</span><span class="va">t1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.filter.callrate </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Recalculating Call Rate</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Removing loci based on Call Rate, threshold = 0.95 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.grm.network-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.filter.callrate </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># relatedness matrix</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.grm.html">gl.grm</a></span><span class="op">(</span><span class="va">t1</span>,plotheatmap <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.grm </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.grm </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># relatedness network</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">gl.grm.network</span><span class="op">(</span><span class="va">res</span>,<span class="va">t1</span>,relatedness_factor <span class="op">=</span> <span class="fl">0.125</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.grm.network </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.grm.network-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.grm.network </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

