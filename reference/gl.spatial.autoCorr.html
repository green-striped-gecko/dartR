<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Global spatial autocorrelation is a multivariate approach
combining all loci into a single analysis. The autocorrelation coefficient
 "r" is calculated for each pair of individuals in each specified distance
 class. For more information see Smouse and Peakall 1999, Peakall et al. 2003
  and Smouse et al. 2008.'><title>Spatial autocorrelation following Smouse and Peakall 1999 — gl.spatial.autoCorr • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial autocorrelation following Smouse and Peakall 1999 — gl.spatial.autoCorr"><meta property="og:description" content='Global spatial autocorrelation is a multivariate approach
combining all loci into a single analysis. The autocorrelation coefficient
 "r" is calculated for each pair of individuals in each specified distance
 class. For more information see Smouse and Peakall 1999, Peakall et al. 2003
  and Smouse et al. 2008.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatial autocorrelation following Smouse and Peakall 1999</h1>
      
      <div class="d-none name"><code>gl.spatial.autoCorr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Global spatial autocorrelation is a multivariate approach
combining all loci into a single analysis. The autocorrelation coefficient
 "r" is calculated for each pair of individuals in each specified distance
 class. For more information see Smouse and Peakall 1999, Peakall et al. 2003
  and Smouse et al. 2008.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.spatial.autoCorr</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dgeo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dgen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coordinates <span class="op">=</span> <span class="st">"latlon"</span>,</span>
<span>  Dgen_method <span class="op">=</span> <span class="st">"Euclidean"</span>,</span>
<span>  Dgeo_trans <span class="op">=</span> <span class="st">"Dgeo"</span>,</span>
<span>  Dgen_trans <span class="op">=</span> <span class="st">"Dgen"</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  plot.pops.together <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  permutation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_theme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_colors_pop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CI_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save2tmp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Genlight object [default NULL].</p></dd>


<dt>Dgeo</dt>
<dd><p>Geographic distance matrix if no genlight object is provided. This
is typically an Euclidean distance but it can be any meaningful 
(geographical) distance metrics [default NULL].</p></dd>


<dt>Dgen</dt>
<dd><p>Genetic distance matrix if no genlight object is provided
[default NULL].</p></dd>


<dt>coordinates</dt>
<dd><p>Can be either 'latlon', 'xy' or a two column data.frame
with column names 'lat','lon', 'x', 'y')  Coordinates are provided via
<code>gl@other$latlon</code> ['latlon'] or via <code>gl@other$xy</code> ['xy']. If latlon
data will be projected to meters using Mercator system [google maps] or if
xy then distance is directly calculated on the coordinates [default .</p></dd>


<dt>Dgen_method</dt>
<dd><p>Method to calculate genetic distances. See details
[default "Euclidean"].</p></dd>


<dt>Dgeo_trans</dt>
<dd><p>Transformation to be used on the geographic distances. See
Dgen_trans [default "Dgeo"].</p></dd>


<dt>Dgen_trans</dt>
<dd><p>You can provide a formula to transform the genetic
distance. The transformation can be applied as a formula using Dgen as the
 variable to be transformed. For example: <code>Dgen_trans = 'Dgen/(1-Dgen)'.
  Any valid R expression can be used here 
  [default 'Dgen', which is the identity function.]</code></p></dd>


<dt>bins</dt>
<dd><p>The number of bins for the distance classes
(i.e. <code>length(bins) == 1)</code> or a vectors with the break points. See 
details [default 5].</p></dd>


<dt>reps</dt>
<dd><p>The number to be used for permutation and bootstrap analyses
[default 100].</p></dd>


<dt>plot.pops.together</dt>
<dd><p>Plot all the populations in one plot. Confidence 
intervals from permutations are not shown [default FALSE].</p></dd>


<dt>permutation</dt>
<dd><p>Whether permutation calculations for the null hypothesis 
of no spatial structure should be carried out [default TRUE].</p></dd>


<dt>bootstrap</dt>
<dd><p>Whether bootstrap calculations to compute the 95% confidence
intervals around r should be carried out [default TRUE].</p></dd>


<dt>plot_theme</dt>
<dd><p>Theme for the plot. See details [default NULL].</p></dd>


<dt>plot_colors_pop</dt>
<dd><p>A color palette for populations or a list with
as many colors as there are populations in the dataset [default NULL].</p></dd>


<dt>CI_color</dt>
<dd><p>Color for the shade of the 95% confidence intervals around 
the r estimates [default "red"].</p></dd>


<dt>plot.out</dt>
<dd><p>Specify if plot is to be produced [default TRUE].</p></dd>


<dt>save2tmp</dt>
<dd><p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p></dd>


<dt>verbose</dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report [default
 NULL, unless specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a data frame with the following columns:</p><ol><li><p>Bin  The distance classes</p></li>
<li><p>N The number of pairwise comparisons within each distance class</p></li>
<li><p>r.uc The uncorrected autocorrelation coefficient</p></li>
<li><p>Correction the correction</p></li>
<li><p>r The corrected autocorrelation coefficient</p></li>
<li><p>L.r The corrected autocorrelation coefficient lower limit
(if <code>bootstap = TRUE</code>)</p></li>
<li><p>U.r The corrected autocorrelation coefficient upper limit
(if <code>bootstap = TRUE</code>)</p></li>
<li><p>L.r.null.uc The uncorrected lower limit for the null hypothesis of no 
spatial autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>U.r.null.uc  The uncorrected upper limit for the null hypothesis of no 
spatial autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>L.r.null The corrected lower limit for the null hypothesis of no 
spatial autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>U.r.null The corrected upper limit for the null hypothesis of no 
spatial autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>p.one.tail The p value of the one tail statistical test</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function executes a modified version
 of <code>spautocorr</code> from the package <code>PopGenReport</code>. Differently 
from <code>PopGenReport</code>, this function also computes the 95% confidence 
intervals around the r via bootstraps, the 95<!-- % confidence interval around the  -->
null hypothesis of no spatial structure and the one-tail test via permutation, 
and the correction factor described by Peakall et al 2003.</p>
<p>The input can be i) a genlight object (which has to have the latlon slot 
populated), ii) a pair of <code>Dgeo</code> and <code>Dgen</code>, which have to be either
 <code>matrix</code> or <code>dist</code> objects, or iii) a <code>list</code> of the 
 <code>matrix</code> or <code>dist</code> objects if the 
 analysis needs to be carried out for multiple populations (in this case, 
 all the elements of the <code>list</code> have to be of the same class (i.e. 
 <code>matrix</code> or <code>dist</code>) and the population order in the two lists has 
 to be the same.</p>
<p>If the input is a genlight object, the function calculates the linear distance
for <code>Dgeo</code> and the relevant <code>Dgen</code> matrix (see <code>Dgen_method</code>) 
for each population. 
When the method selected is a genetic similarity matrix (e.g. "simple" 
distance), the matrix is internally transformed with <code>1 - Dgen</code> so that 
positive values of autocorrelation coefficients indicates more related 
individuals similarly as implemented in GenAlEx. If the user provide the 
distance matrices, care must be taken in interpreting the results because
similarity matrix will generate negative values for closely related 
individuals.</p>
<p>If <code>max(Dgeo)&gt;1000</code> (e.g. the geographic distances are in thousands of 
metres), values are divided by 1000 (in the example before these would then 
become km) to facilitate readability of the plots.</p>
<p>If <code>bins</code> is of length = 1 it is interpreted as the number of (even)
bins to use. In this case the starting point is always the minimum value in 
the distance matrix, and the last is the maximum. If it is a numeric vector 
of length&gt;1, it is interpreted as the breaking points. In this case, the 
first has to be the lowest value, and the last has to be the highest. There 
are no internal checks for this and it is user responsibility to ensure that
distance classes are properly set up. If that is not the case, data that fall
outside the range provided will be dropped. The number of bins will be 
<code>length(bins) - 1</code>.</p>
<p>The permutation constructs the 95% confidence intervals around the null
hypothesis of no spatial structure (this is a two-tail test). The same data
are also used to calculate the probability of the one-tail test (See 
references below for details).</p>
<p>Bootstrap calculations are skipped and <code>NA</code> is returned when the number 
of possible combinations given the sample size of any given distance class is
&lt; <code>reps</code>.</p>
<p>Methods available to calculate genetic distances for SNP data:</p><ul><li><p>"propShared" using the function <code><a href="gl.propShared.html">gl.propShared</a></code>.</p></li>
<li><p>"grm" using the function <code><a href="gl.grm.html">gl.grm</a></code>.</p></li>
<li><p>"Euclidean" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Simple" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Absolute" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Manhattan" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
</ul><p>Methods available to calculate genetic distances for SilicoDArT data:</p><ul><li><p>"Euclidean" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Simple" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Jaccard" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
<li><p>"Bray-Curtis" using the function <code><a href="gl.dist.ind.html">gl.dist.ind</a></code>.</p></li>
</ul><p>Plots and table are saved to the temporal directory (tempdir) and can be
 accessed with the function <code><a href="gl.print.reports.html">gl.print.reports</a></code> and listed with
 the function <code><a href="gl.list.reports.html">gl.list.reports</a></code>. Note that they can be accessed
 only in the current R session because tempdir is cleared each time that the
  R session is closed.</p>
<p>Examples of other themes that can be used can be consulted in</p><ul><li><p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and</p></li>
<li><p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="external-link">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Smouse PE, Peakall R. 1999. Spatial autocorrelation analysis of
individual multiallele and multilocus genetic structure. Heredity 82:
561-573.</p></li>
<li><p>Double, MC, et al. 2005. Dispersal, philopatry and infidelity: 
dissecting local genetic structure in superb fairy-wrens (Malurus cyaneus). 
Evolution 59, 625-635.</p></li>
<li><p>Peakall, R, et al. 2003. Spatial autocorrelation analysis offers new
insights into gene flow in the Australian bush rat, Rattus fuscipes.
Evolution 57, 1182-1195.</p></li>
<li><p>Smouse, PE, et al. 2008. A heterogeneity test for fine-scale genetic
structure. Molecular Ecology 17, 3389-3400.</p></li>
<li><p>Gonzales, E, et al. 2010. The impact of landscape disturbance on 
spatial genetic structure in the Guanacaste tree, Enterolobium
cyclocarpum (Fabaceae). Journal of Heredity 101, 133-143.</p></li>
<li><p>Beck, N, et al. 2008. Social constraint and an absence of sex-biased
dispersal drive fine-scale genetic structure in white-winged choughs.
Molecular Ecology 17, 4346-4358.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Carlo Pacioni, Bernd Gruber &amp; Luis Mijangos 
(Post to <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/green-striped-gecko/dartR.data" class="external-link">"dartR.data"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.spatial.autoCorr</span><span class="op">(</span><span class="va">platypus.gl</span>, bins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span>,<span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Analysis performed on the genlight object.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.spatial.autoCorr-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Coordinates used from: x@other$latlon (Mercator transformed) </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Transformation of Dgeo: Dgeo </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Genetic distance: Euclidean </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Tranformation of Dgen:  Dgen </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SEVERN_ABOVE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bin  N        r.uc Correction             r          L.r          U.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2000 76 -0.02564315 0.04545455  0.0198113993  0.002186888  0.042801625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4000 32 -0.07220725 0.04545455 -0.0267527002 -0.037957563 -0.015770390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6000 13 -0.04414587 0.04545455  0.0013086741 -0.007002320  0.009418026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8000  8 -0.06046684 0.04545455 -0.0150122948 -0.047718665  0.012329992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 10000 23 -0.04622188 0.04545455 -0.0007673346 -0.020133414  0.022471028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L.r.null.uc U.r.null.uc    L.r.null   U.r.null p.one.tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.05498292 -0.03215896 -0.00952837 0.01329559       0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.06613841 -0.02434717 -0.02068387 0.02110738       0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.06651506 -0.01096856 -0.02106051 0.03448598       0.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.07887799 -0.01511102 -0.03342345 0.03034353       0.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.06514824 -0.02724258 -0.01969370 0.01821196       0.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SEVERN_BELOW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bin  N        r.uc Correction             r           L.r         U.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2000 17 -0.05393927     0.0625  0.0085607267 -0.0086902590 0.031007604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4000 24 -0.04707985     0.0625  0.0154201481 -0.0000196379 0.028993794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6000  9 -0.06664774     0.0625 -0.0041477406 -0.0342505737 0.019405257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8000 30 -0.06997976     0.0625 -0.0074797574 -0.0177938696 0.003185218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 10000 21 -0.06198526     0.0625  0.0005147397 -0.0121786361 0.018082288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L.r.null.uc U.r.null.uc     L.r.null   U.r.null p.one.tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.08255125 -0.04558095 -0.020051254 0.01691905       0.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.07507161 -0.04823637 -0.012571606 0.01426363       0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.08038917 -0.04559409 -0.017889170 0.01690591       0.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.07170738 -0.05072362 -0.009207384 0.01177638       0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.07497562 -0.04815008 -0.012475616 0.01434992       0.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $TENTERFIELD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bin   N         r.uc Correction             r          L.r         U.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2000 110 -0.001971616      0.025  2.302838e-02  0.008980646 0.042430807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4000  54 -0.031927379      0.025 -6.927379e-03 -0.017704510 0.003485523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6000  67 -0.025089835      0.025 -8.983472e-05 -0.008458303 0.008413280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8000  20 -0.019438357      0.025  5.561643e-03 -0.010372635 0.019333636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 10000  37 -0.024745610      0.025  2.543903e-04 -0.011459280 0.017521843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L.r.null.uc  U.r.null.uc     L.r.null   U.r.null p.one.tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.03320862 -0.014659282 -0.008208619 0.01034072       0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.03755126 -0.009700107 -0.012551262 0.01529989       0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.03532374 -0.013177642 -0.010323741 0.01182236       0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.04079043  0.013196920 -0.015790431 0.03819692       0.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.03952234 -0.010117703 -0.014522339 0.01488230       0.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># using one population, showing sample size</span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.keep.pop.html">gl.keep.pop</a></span><span class="op">(</span><span class="va">platypus.gl</span>,pop.list <span class="op">=</span> <span class="st">"TENTERFIELD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.keep.pop </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: data include loci that are scored NA across all individuals.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Consider filtering using gl &lt;- gl.filter.allna(gl)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Checking for presence of nominated populations</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Retaining only populations TENTERFIELD </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: Resultant dataset may contain monomorphic loci</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Locus metrics not recalculated</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.keep.pop </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.spatial.autoCorr</span><span class="op">(</span><span class="va">test</span>, bins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span>,<span class="fl">2000</span><span class="op">)</span>,CI_color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Analysis performed on the genlight object.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">x</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="gl.spatial.autoCorr-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Coordinates used from: x@other$latlon (Mercator transformed) </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Transformation of Dgeo: Dgeo </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Genetic distance: Euclidean </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Tranformation of Dgen:  Dgen </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $TENTERFIELD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bin   N         r.uc Correction             r          L.r         U.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2000 110 -0.001971616      0.025  2.302838e-02  0.006177584 0.046089658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4000  54 -0.031927379      0.025 -6.927379e-03 -0.016069334 0.003954427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6000  67 -0.025089835      0.025 -8.983472e-05 -0.008797311 0.008154147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8000  20 -0.019438357      0.025  5.561643e-03 -0.015974007 0.016444506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 10000  37 -0.024745610      0.025  2.543903e-04 -0.010420643 0.015527516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L.r.null.uc  U.r.null.uc     L.r.null   U.r.null p.one.tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.03336787 -0.014358586 -0.008367874 0.01064141       0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.03627298 -0.007285241 -0.011272975 0.01771476       0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.03451288 -0.008479086 -0.009512876 0.01652091       0.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.04320952  0.009828255 -0.018209519 0.03482825       0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.03915205 -0.008647385 -0.014152045 0.01635262       0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.keep.pop.html">gl.keep.pop</a></span><span class="op">(</span><span class="va">platypus.gl</span>,pop.list <span class="op">=</span> <span class="st">"TENTERFIELD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.keep.pop </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: data include loci that are scored NA across all individuals.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Consider filtering using gl &lt;- gl.filter.allna(gl)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Checking for presence of nominated populations</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Retaining only populations TENTERFIELD </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: Resultant dataset may contain monomorphic loci</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Locus metrics not recalculated</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.keep.pop </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.spatial.autoCorr</span><span class="op">(</span><span class="va">test</span>, bins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span>,<span class="fl">2000</span><span class="op">)</span>,CI_color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Analysis performed on the genlight object.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">x</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="gl.spatial.autoCorr-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Coordinates used from: x@other$latlon (Mercator transformed) </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Transformation of Dgeo: Dgeo </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Genetic distance: Euclidean </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Tranformation of Dgen:  Dgen </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $TENTERFIELD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bin   N         r.uc Correction             r          L.r         U.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2000 110 -0.001971616      0.025  2.302838e-02  0.005981018 0.050318428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4000  54 -0.031927379      0.025 -6.927379e-03 -0.015702721 0.002032892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  6000  67 -0.025089835      0.025 -8.983472e-05 -0.007213233 0.006633325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  8000  20 -0.019438357      0.025  5.561643e-03 -0.007675353 0.020588165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 10000  37 -0.024745610      0.025  2.543903e-04 -0.013046058 0.017942032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   L.r.null.uc  U.r.null.uc     L.r.null    U.r.null p.one.tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.03335178 -0.016516067 -0.008351782 0.008483933       0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.03609696 -0.012860555 -0.011096960 0.012139445       0.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.03726668 -0.009925303 -0.012266678 0.015074697       0.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.04197121  0.008491727 -0.016971206 0.033491727       0.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.03923018  0.000276256 -0.014230176 0.025276256       0.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

