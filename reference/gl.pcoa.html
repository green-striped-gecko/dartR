<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ordination applied to genotypes in a genlight object (PCA), in an fd object, or to a distance matrix (PCoA) — gl.pcoa • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ordination applied to genotypes in a genlight object (PCA), in an fd object, or to a distance matrix (PCoA) — gl.pcoa"><meta name="description" content="This function takes the genotypes for individuals and undertakes a Pearson
Principal Component analysis (PCA) on SNP or Tag P/A (SilicoDArT) data; it
undertakes a Gower Principal Coordinate analysis (PCoA) if supplied with a
distance matrix. Technically, any distance matrix can be represented in an
ordinated space using PCoA."><meta property="og:description" content="This function takes the genotypes for individuals and undertakes a Pearson
Principal Component analysis (PCA) on SNP or Tag P/A (SilicoDArT) data; it
undertakes a Gower Principal Coordinate analysis (PCoA) if supplied with a
distance matrix. Technically, any distance matrix can be represented in an
ordinated space using PCoA."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/green-striped-gecko/dartR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ordination applied to genotypes in a genlight object (PCA), in an fd object, or to a distance matrix (PCoA)</h1>
      <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.pcoa.r" class="external-link"><code>R/gl.pcoa.r</code></a></small>
      <div class="d-none name"><code>gl.pcoa.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes the genotypes for individuals and undertakes a Pearson
Principal Component analysis (PCA) on SNP or Tag P/A (SilicoDArT) data; it
undertakes a Gower Principal Coordinate analysis (PCoA) if supplied with a
distance matrix. Technically, any distance matrix can be represented in an
ordinated space using PCoA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.pcoa</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  nfactors <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  correction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mono.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n.cores <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_theme <span class="op">=</span> <span class="fu"><a href="theme_dartR.html">theme_dartR</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plot_colors <span class="op">=</span> <span class="va">two_colors</span>,</span>
<span>  save2tmp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Name of the genlight object or fd object containing the SNP data, or
a distance matrix of type dist [required].</p></dd>


<dt id="arg-nfactors">nfactors<a class="anchor" aria-label="anchor" href="#arg-nfactors"></a></dt>
<dd><p>Number of axes to retain in the output of factor scores
[default 5].</p></dd>


<dt id="arg-correction">correction<a class="anchor" aria-label="anchor" href="#arg-correction"></a></dt>
<dd><p>Method applied to correct for negative eigenvalues, either
'lingoes' or 'cailliez' [Default NULL].</p></dd>


<dt id="arg-mono-rm">mono.rm<a class="anchor" aria-label="anchor" href="#arg-mono-rm"></a></dt>
<dd><p>If TRUE, remove monomorphic loci [default TRUE].</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>TRUE if parallel processing is required (does fail under
Windows) [default FALSE].</p></dd>


<dt id="arg-n-cores">n.cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Number of cores to use if parallel processing is requested
[default 16].</p></dd>


<dt id="arg-plot-out">plot.out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>If TRUE, a diagnostic plot is displayed showing a scree plot
for the "informative" axes and a histogram of eigenvalues of the remaining
"noise" axes [Default TRUE].</p></dd>


<dt id="arg-plot-theme">plot_theme<a class="anchor" aria-label="anchor" href="#arg-plot-theme"></a></dt>
<dd><p>Theme for the plot. See Details for options
[default theme_dartR()].</p></dd>


<dt id="arg-plot-colors">plot_colors<a class="anchor" aria-label="anchor" href="#arg-plot-colors"></a></dt>
<dd><p>List of two color names for the borders and fill of the
plot [default two_colors].</p></dd>


<dt id="arg-save-tmp">save2tmp<a class="anchor" aria-label="anchor" href="#arg-save-tmp"></a></dt>
<dd><p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>verbose= 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class pcoa containing the eigenvalues and factor scores</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function is essentially a wrapper for glPca adegenet or pcoa {ape}
with default settings apart from those specified as parameters in this
function.
<strong> Sources of stress in the visual representation </strong></p>
<p>While, technically, any distance matrix can be represented in an ordinated
space, the representation will not typically be exact.There are three major
sources of stress in a reduced-representation of distances or dissimilarities
among entities using PCA or PCoA. By far the greatest source comes from the
decision to select only the top two or three axes from the ordinated set of
axes derived from the PCA or PCoA. The representation of the entities such a
heavily reduced space will not faithfully represent the distances in the
input distance matrix simply because of the loss of information in deeper
informative dimensions. For this reason, it is not sensible to be too
precious about managing the other two sources of stress in the visual
representation.</p>
<p>The measure of distance between entities in a PCA is the Pearson Correlation
Coefficient, essentially a standardized Euclidean distance. This is both a
metric distance and a Euclidean distance. In PCoA, the second source of
stress is the choice of distance measure or dissimilarity measure. While any
distance or dissimilarity matrix can be represented in an ordinated space,
the distances between entities can be faithfully represented in that space
(that is, without stress) only if the distances are metric. Furthermore, for
distances between entities to be faithfully represented in a rigid Cartesian
space, the distance measure needs to be Euclidean. If this is not the case,
the distances between the entities in the ordinated visualized space will not
exactly represent the distances in the input matrix (stress will be non-zero).
This source of stress will be evident as negative eigenvalues in the deeper
 dimensions.</p>
<p>A third source of stress arises from having a sparse dataset, one with
missing values. This affects both PCA and PCoA. If the original data matrix
is not fully populated, that is, if there are missing values, then even a
Euclidean distance matrix will not necessarily be 'positive definite'. It
follows that some of the eigenvalues may be negative, even though the
distance metric is Euclidean. This issue is exacerbated when the number of
loci greatly exceeds the number of individuals, as is typically the case when
working with SNP data. The impact of missing values can be minimized by
stringently filtering on Call Rate, albeit with loss of data. An alternative
is given in a paper 'Honey, I shrunk the sample covariance matrix' and more
recently by Ledoit and Wolf (2018), but their approach has not been
 implemented here.</p>
<p>The good news is that, unless the sum of the negative eigenvalues, arising
from a non-Euclidean distance measure or from missing values, approaches
those of the final PCA or PCoA axes to be displayed, the distortion is
probably of no practical consequence and certainly not comparable to the
stress arising from selecting only two or three final dimensions out of
several informative dimensions for the visual representation.</p>
<p><strong> Function's output </strong></p>
<p>Two diagnostic plots are produced. The first is a Scree Plot, showing the
percentage variation explained by each of the PCA or PCoA axes, for those
axes that explain more than the original variables (loci) on average. That
is, only informative axes are displayed. The scree plot informs the number of
dimensions to be retained in the visual summaries. As a rule of thumb, axes
with more than 10<!-- % of variation explained should be included. --></p>
<p>The second graph shows the distribution of eigenvalues for the remaining
uninformative (noise) axes, including those with negative eigenvalues.</p>
<p>Action is recommended (verbose &gt;= 2) if the negative eigenvalues are
dominant, their sum approaching in magnitude the eigenvalues for axes
selected for the final visual solution.</p>
<p>Output is a glPca object conforming to adegenet::glPca but with only the
following retained.</p><ul><li><p>$call - The call that generated the PCA/PCoA</p></li>
<li><p>$eig - Eigenvalues – All eigenvalues (positive, null, negative).</p></li>
<li><p>$scores - Scores (coefficients) for each individual</p></li>
<li><p>$loadings - Loadings of each SNP for each principal component</p></li>
</ul><p>Plots and table were saved to the temporal directory (tempdir) and can be
accessed with the function <code><a href="gl.print.reports.html">gl.print.reports</a></code> and listed with
the function <code><a href="gl.list.reports.html">gl.list.reports</a></code>. Note that they can be accessed
only in the current R session because tempdir is cleared each time that the R
session is closed.</p>
<p>Examples of other themes that can be used can be consulted in</p><ul><li><p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and</p></li>
<li><p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="external-link">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a></p></li>
</ul><p>PCA was developed by Pearson (1901) and Hotelling (1933), whilst the best
modern reference is Jolliffe (2002). PCoA was developed by Gower (1966) while
the best modern reference is Legendre &amp; Legendre (1998).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Cailliez, F. (1983) The analytical solution of the additive constant
problem. Psychometrika, 48, 305-308.</p></li>
<li><p>Gower, J. C. (1966) Some distance properties of latent root and vector
methods used in multivariate analysis. Biometrika, 53, 325-338.</p></li>
<li><p>Hotelling, H., 1933. Analysis of a complex of statistical variables into
Principal Components. Journal of Educational Psychology 24:417-441, 498-520.</p></li>
<li><p>Jolliffe, I. (2002) Principal Component Analysis. 2nd Edition, Springer,
New York.</p></li>
<li><p>Ledoit, O. and Wolf, M. (2018). Analytical nonlinear shrinkage of
large-dimensional covariance matrices. University of Zurich, Department of
Economics, Working Paper No. 264, Revised version. Available at SSRN:
https://ssrn.com/abstract=3047302 or http://dx.doi.org/10.2139/ssrn.3047302</p></li>
<li><p>Legendre, P. and Legendre, L. (1998). Numerical Ecology, Volume 24, 2nd
Edition. Elsevier Science, NY.</p></li>
<li><p>Lingoes, J. C. (1971) Some boundary conditions for a monotone analysis
of symmetric matrices. Psychometrika, 36, 195-203.</p></li>
<li><p>Pearson, K. (1901). On lines and planes of closest fit to systems of
points in space. Philosophical Magazine. Series 6, vol. 2, no. 11, pp.
559-572.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gl.pcoa.plot.html">gl.pcoa.plot</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Author(s): Arthur Georges. Custodian: Arthur Georges (Post to
<a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="va">possums.gl</span></span></span>
<span class="r-in"><span><span class="co"># PCA (using SNP genlight object)</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu">gl.pcoa</span><span class="op">(</span><span class="va">possums.gl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span>,verbose<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.pcoa.plot.html">gl.pcoa.plot</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">gl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="va">testset.gs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">pop</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Coast'</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Cooper'</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Coast'</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'MDB'</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Coast'</span>,<span class="fl">6</span><span class="op">)</span>,<span class="st">'Em.subglobosa'</span>,<span class="st">'Em.victoriae'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA (using SilicoDArT genlight object)</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu">gl.pcoa</span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.pcoa.plot.html">gl.pcoa.plot</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">gs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Collapsing pops to OTUs using Fixed Difference Analysis (using fd object)</span></span></span>
<span class="r-in"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.fixed.diff.html">gl.fixed.diff</a></span><span class="op">(</span><span class="va">testset.gl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.collapse.html">gl.collapse</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu">gl.pcoa</span><span class="op">(</span><span class="va">fd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.pcoa.plot.html">gl.pcoa.plot</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">fd</span><span class="op">$</span><span class="va">gl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using a distance matrix</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.dist.ind.html">gl.dist.ind</a></span><span class="op">(</span><span class="va">testset.gs</span>, method<span class="op">=</span><span class="st">'jaccard'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcoa</span> <span class="op">&lt;-</span> <span class="fu">gl.pcoa</span><span class="op">(</span><span class="va">D</span>,correction<span class="op">=</span><span class="st">"cailliez"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.pcoa.plot.html">gl.pcoa.plot</a></span><span class="op">(</span><span class="va">pcoa</span>,<span class="va">gs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

