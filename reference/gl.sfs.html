<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Creates a site frequency spectrum based on a dartR or genlight object — gl.sfs • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a site frequency spectrum based on a dartR or genlight object — gl.sfs"><meta name="description" content="Creates a site frequency spectrum based on a dartR or genlight object"><meta property="og:description" content="Creates a site frequency spectrum based on a dartR or genlight object"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/green-striped-gecko/dartR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creates a site frequency spectrum based on a dartR or genlight object</h1>
      <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.sfs.R" class="external-link"><code>R/gl.sfs.R</code></a></small>
      <div class="d-none name"><code>gl.sfs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a site frequency spectrum based on a dartR or genlight object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.sfs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  minbinsize <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  folded <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  singlepop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>dartR/genlight object</p></dd>


<dt id="arg-minbinsize">minbinsize<a class="anchor" aria-label="anchor" href="#arg-minbinsize"></a></dt>
<dd><p>remove bins from the left of the sfs. For example to remove
singletons (alleles only occurring once among all individuals) set
minbinsize to 2. If set to zero, also monomorphic (d0) loci are returned.</p></dd>


<dt id="arg-folded">folded<a class="anchor" aria-label="anchor" href="#arg-folded"></a></dt>
<dd><p>if set to TRUE (default) a folded sfs (minor allele frequency
sfs) is returned. If set to FALSE then an unfolded (derived allele frequency
 sfs) is returned. It is assumed that 0 is homozygote for the reference and
 2 is homozygote for the derived allele. So you need to make sure your
 coding is correct.</p></dd>


<dt id="arg-singlepop">singlepop<a class="anchor" aria-label="anchor" href="#arg-singlepop"></a></dt>
<dd><p>switch to force to create a one-dimensional sfs, even
though the genlight/dartR object contains more than one population</p></dd>


<dt id="arg-plot-out">plot.out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>Specify if plot is to be produced [default TRUE].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2, unless specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>returns a site frequency spectrum, either a one dimensional vector
(only a single population in the dartR/genlight object or singlepop=TRUE) or
an n-dimensional array (n is the number of populations in the genlight/dartR
 object). If the dartR/genlight object consists of several populations the
  multidimensional site frequency spectrum for each population is returned
   [=a multidimensional site frequency spectrum]. Be aware the
   multidimensional spectrum works only for a limited number of population
    and individuals [if too high the table command used internally will
    through an error as the number of populations and individuals (and
    therefore dimensions) are too large]. To get a single sfs for a
    genlight/dartR object with multiple populations, you need to set
    singlepop to TRUE. The returned sfs can be used to analyse demographics,
     e.g. using fastsimcoal2.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Excoffier L., Dupanloup I., Huerta-Sánchez E., Sousa V. C. and
 Foll M. (2013) Robust demographic inference from genomic and SNP data. PLoS
 genetics 9(10)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Custodian: Bernd Gruber &amp; Carlo Pacioni (Post to
 <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">gl.sfs</span><span class="op">(</span><span class="va">bandicoot.gl</span>, singlepop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Your data contains missing data, better to use gl.impute to fill those gaps meaningful!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.sfs-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  d0  d1  d2  d3  d4  d5  d6  d7  d8  d9 d10 d11 d12 d13 d14 d15 d16 d17 d18 d19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8   4   0   1   6   8   6   8   8   5   8   6   9  10   9   8   6  12   8  14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d20 d21 d22 d23 d24 d25 d26 d27 d28 d29 d30 d31 d32 d33 d34 d35 d36 d37 d38 d39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12  20  17  14  11  18   8  12  15  13  12  13  10  17  11  18  14  14  19   7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d40 d41 d42 d43 d44 d45 d46 d47 d48 d49 d50 d51 d52 d53 d54 d55 d56 d57 d58 d59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15   8   7  12  21  15  14  16  10  13   8  11  10  18   9  13   8  12  11   7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d60 d61 d62 d63 d64 d65 d66 d67 d68 d69 d70 d71 d72 d73 d74 d75 d76 d77 d78 d79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11  14  15  10  12   6  17  12  14   6  11  10  12  13  12   9   3   8   6  11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d80 d81 d82 d83 d84 d85 d86 d87 d88 d89 d90 d91 d92 d93 d94 d95 d96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   7   9   6   7   8   6  14  10   8   4  10  13   6   5  10   4 </span>
<span class="r-in"><span><span class="fu">gl.sfs</span><span class="op">(</span><span class="va">possums.gl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">31</span><span class="op">:</span><span class="fl">33</span><span class="op">)</span>,<span class="op">]</span>, minbinsize<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">The sfs has more than 2 dimensions, therefore no plot is returned</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A     d1 d2 d3 d4 d5 d6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d1  12  4  6  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d2   2 14  5  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d3  13 18 11  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d4  11 15  8  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d5   5  8  5  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d6   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d7   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d8   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d9   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d10  0  0  0  0  0  0</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

