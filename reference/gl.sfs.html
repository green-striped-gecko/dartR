<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Creates a site frequency spectrum based on a dartR or genlight object — gl.sfs • dartR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a site frequency spectrum based on a dartR or genlight object — gl.sfs"><meta property="og:description" content="Creates a site frequency spectrum based on a dartR or genlight object"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9.9.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dartRTutorials.html">dartR Tutorials</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/green-striped-gecko/dartR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates a site frequency spectrum based on a dartR or genlight object</h1>
    <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.sfs.R" class="external-link"><code>R/gl.sfs.R</code></a></small>
    <div class="hidden name"><code>gl.sfs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a site frequency spectrum based on a dartR or genlight object</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.sfs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  minbinsize <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  folded <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  singlepop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>dartR/genlight object</p></dd>


<dt id="arg-minbinsize">minbinsize<a class="anchor" aria-label="anchor" href="#arg-minbinsize"></a></dt>
<dd><p>remove bins from the left of the sfs. For example to remove
singletons (alleles only occurring once among all individuals) set
minbinsize to 2. If set to zero, also monomorphic (d0) loci are returned.</p></dd>


<dt id="arg-folded">folded<a class="anchor" aria-label="anchor" href="#arg-folded"></a></dt>
<dd><p>if set to TRUE (default) a folded sfs (minor allele frequency
sfs) is returned. If set to FALSE then an unfolded (derived allele frequency
 sfs) is returned. It is assumed that 0 is homozygote for the reference and
 2 is homozygote for the derived allele. So you need to make sure your
 coding is correct.</p></dd>


<dt id="arg-singlepop">singlepop<a class="anchor" aria-label="anchor" href="#arg-singlepop"></a></dt>
<dd><p>switch to force to create a one-dimensional sfs, even
though the genlight/dartR object contains more than one population</p></dd>


<dt id="arg-plot-out">plot.out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>Specify if plot is to be produced [default TRUE].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2, unless specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>returns a site frequency spectrum, either a one dimensional vector
(only a single population in the dartR/genlight object or singlepop=TRUE) or
an n-dimensional array (n is the number of populations in the genlight/dartR
 object). If the dartR/genlight object consists of several populations the
  multidimensional site frequency spectrum for each population is returned
   [=a multidimensional site frequency spectrum]. Be aware the
   multidimensional spectrum works only for a limited number of population
    and individuals [if too high the table command used internally will
    through an error as the number of populations and individuals (and
    therefore dimensions) are too large]. To get a single sfs for a
    genlight/dartR object with multiple populations, you need to set
    singlepop to TRUE. The returned sfs can be used to analyse demographics,
     e.g. using fastsimcoal2.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Excoffier L., Dupanloup I., Huerta-Sánchez E., Sousa V. C. and
 Foll M. (2013) Robust demographic inference from genomic and SNP data. PLoS
 genetics 9(10)</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Custodian: Bernd Gruber &amp; Carlo Pacioni (Post to
 <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">gl.sfs</span><span class="op">(</span><span class="va">bandicoot.gl</span>, singlepop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Your data contains missing data, better to use gl.impute to fill those gaps meaningful!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.sfs-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  d0  d1  d2  d3  d4  d5  d6  d7  d8  d9 d10 d11 d12 d13 d14 d15 d16 d17 d18 d19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8   4   0   1   6   8   6   8   8   5   8   6   9  10   9   8   6  12   8  14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d20 d21 d22 d23 d24 d25 d26 d27 d28 d29 d30 d31 d32 d33 d34 d35 d36 d37 d38 d39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12  20  17  14  11  18   8  12  15  13  12  13  10  17  11  18  14  14  19   7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d40 d41 d42 d43 d44 d45 d46 d47 d48 d49 d50 d51 d52 d53 d54 d55 d56 d57 d58 d59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15   8   7  12  21  15  14  16  10  13   8  11  10  18   9  13   8  12  11   7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d60 d61 d62 d63 d64 d65 d66 d67 d68 d69 d70 d71 d72 d73 d74 d75 d76 d77 d78 d79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11  14  15  10  12   6  17  12  14   6  11  10  12  13  12   9   3   8   6  11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d80 d81 d82 d83 d84 d85 d86 d87 d88 d89 d90 d91 d92 d93 d94 d95 d96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   7   9   6   7   8   6  14  10   8   4  10  13   6   5  10   4 </span>
<span class="r-in"><span><span class="fu">gl.sfs</span><span class="op">(</span><span class="va">possums.gl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">31</span><span class="op">:</span><span class="fl">33</span><span class="op">)</span>,<span class="op">]</span>, minbinsize<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">The sfs has more than 2 dimensions, therefore no plot is returned</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.sfs </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A     d1 d2 d3 d4 d5 d6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d1  12  4  6  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d2   2 14  5  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d3  13 18 11  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d4  11 15  8  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d5   5  8  5  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d6   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d7   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d8   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d9   0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   d10  0  0  0  0  0  0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

