<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulates individuals based on the allele frequencies provided via a genlight
object. — gl.sim.ind • dartR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulates individuals based on the allele frequencies provided via a genlight
object. — gl.sim.ind"><meta property="og:description" content="This function simulates individuals based on the allele frequencies of a
genlight object. The output is a genlight object with the same number of loci
as the input genlight object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dartRTutorials.html">dartR Tutorials</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulates individuals based on the allele frequencies provided via a genlight
object.</h1>
    
    <div class="hidden name"><code>gl.sim.ind.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function simulates individuals based on the allele frequencies of a
genlight object. The output is a genlight object with the same number of loci
as the input genlight object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.sim.ind</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fl">50</span>, popname <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Name of the genlight object containing the SNP data [required].</p></dd>


<dt>n</dt>
<dd><p>Number of individuals that should be simulated [default 50].</p></dd>


<dt>popname</dt>
<dd><p>A population name for the simulated individuals [default NULL].</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A genlight object with n individuals.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function can be used to simulate populations for sampling designs or for
 power analysis. Check the example below where the effect of drift is
  explored, by simply simulating several generation a genlight object and 
  putting in the allele frequencies of the previous generation. The beauty of
   the function is, that it is lightning fast. Be aware this is a simulation 
   and to avoid lengthy error checking the function crashes if there are loci 
   that have just NAs. If such a case can occur during your simulation, those
   loci need to be removed, before the function is called.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bernd Gruber (bernd.gruber@canberra.edu.au)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">glsim</span> <span class="op">&lt;-</span> <span class="fu">gl.sim.ind</span><span class="op">(</span><span class="va">testset.gl</span>, n<span class="op">=</span><span class="fl">10</span>, popname<span class="op">=</span><span class="st">'sims'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glsim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  /// GENLIGHT OBJECT /////////</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  // 10 genotypes,  255 binary SNPs, size: 43.3 Kb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 (0 %) missing data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  // Basic content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @gen: list of 10 SNPbin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @ploidy: ploidy of each individual  (range: 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  // Optional content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @ind.names:  10 individual labels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @loc.names:  255 locus labels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @loc.all:  255 alleles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @position: integer storing positions of the SNPs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @pop: population of each individual (group size range: 10-10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    @other: a list containing: elements without names </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">###Simulate drift over 10 generation</span></span></span>
<span class="r-in"><span><span class="co"># assuming a bottleneck of only 10 individuals</span></span></span>
<span class="r-in"><span><span class="co"># [ignoring effect of mating and mutation]</span></span></span>
<span class="r-in"><span><span class="co"># Simulate 20 individuals with no structure and 50 SNP loci</span></span></span>
<span class="r-in"><span><span class="va">founder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/glSim.html" class="external-link">glSim</a></span><span class="op">(</span>n.ind <span class="op">=</span> <span class="fl">20</span>, n.snp.nonstruc <span class="op">=</span> <span class="fl">50</span>, ploidy<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#number of fixed loci in the first generation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">founder</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">2</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">simgl</span> <span class="op">&lt;-</span> <span class="va">founder</span></span></span>
<span class="r-in"><span><span class="co">#49 generations of only 10 individuals</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">simgl</span> <span class="op">&lt;-</span> <span class="fu">gl.sim.ind</span><span class="op">(</span><span class="va">simgl</span>, n<span class="op">=</span><span class="fl">10</span>, popname<span class="op">=</span><span class="st">'sims'</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">res</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">simgl</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span><span class="fl">2</span> <span class="op">==</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="va">res</span>, type<span class="op">=</span><span class="st">'b'</span>, xlab<span class="op">=</span><span class="st">'generation'</span>, ylab<span class="op">=</span><span class="st">'# fixed loci'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gl.sim.ind-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

