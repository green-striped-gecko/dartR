<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aligns nucleotides sequences against those present in a target database using blastn — gl.blast • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aligns nucleotides sequences against those present in a target database using blastn — gl.blast"><meta name="description" content="Basic Local Alignment Search Tool (BLAST; Altschul et al., 1990 &amp;amp;
 1997) is a sequence comparison algorithm optimized for speed used to search
 sequence databases for optimal local alignments to a query. This function
 creates fasta files, creates databases to run BLAST, runs blastn and filters
 these results to obtain the best hit per sequence.
This function can be used to run BLAST alignment of short-read (DArTseq
 data) and long-read sequences (Illumina, PacBio... etc). You can use
 reference genomes from NCBI, genomes from your private collection, contigs,
 scaffolds or any other genetic sequence that you would like to use as
 reference."><meta property="og:description" content="Basic Local Alignment Search Tool (BLAST; Altschul et al., 1990 &amp;amp;
 1997) is a sequence comparison algorithm optimized for speed used to search
 sequence databases for optimal local alignments to a query. This function
 creates fasta files, creates databases to run BLAST, runs blastn and filters
 these results to obtain the best hit per sequence.
This function can be used to run BLAST alignment of short-read (DArTseq
 data) and long-read sequences (Illumina, PacBio... etc). You can use
 reference genomes from NCBI, genomes from your private collection, contigs,
 scaffolds or any other genetic sequence that you would like to use as
 reference."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/green-striped-gecko/dartR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aligns nucleotides sequences against those present in a target database using blastn</h1>
      <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.blast.r" class="external-link"><code>R/gl.blast.r</code></a></small>
      <div class="d-none name"><code>gl.blast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Basic Local Alignment Search Tool (BLAST; Altschul et al., 1990 &amp;
 1997) is a sequence comparison algorithm optimized for speed used to search
 sequence databases for optimal local alignments to a query. This function
 creates fasta files, creates databases to run BLAST, runs blastn and filters
 these results to obtain the best hit per sequence.</p>
<p>This function can be used to run BLAST alignment of short-read (DArTseq
 data) and long-read sequences (Illumina, PacBio... etc). You can use
 reference genomes from NCBI, genomes from your private collection, contigs,
 scaffolds or any other genetic sequence that you would like to use as
 reference.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.blast</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">ref_genome</span>,</span>
<span>  task <span class="op">=</span> <span class="st">"megablast"</span>,</span>
<span>  Percentage_identity <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  Percentage_overlap <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  bitscore <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  number_of_threads <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Either a genlight object containing a column named
'TrimmedSequence' containing the sequence of the SNPs (the sequence tag)
trimmed of adapters as provided by DArT; or a path to a fasta file with the
query sequences [required].</p></dd>


<dt id="arg-ref-genome">ref_genome<a class="anchor" aria-label="anchor" href="#arg-ref-genome"></a></dt>
<dd><p>Path to a reference genome in fasta of fna format
[required].</p></dd>


<dt id="arg-task">task<a class="anchor" aria-label="anchor" href="#arg-task"></a></dt>
<dd><p>Four different tasks are supported: 1) “megablast”, for very
similar sequences (e.g, sequencing errors), 2) “dc-megablast”, typically
used for inter-species comparisons, 3) “blastn”, the traditional program
used for inter-species comparisons, 4) “blastn-short”, optimized for
sequences less than 30 nucleotides [default 'megablast'].</p></dd>


<dt id="arg-percentage-identity">Percentage_identity<a class="anchor" aria-label="anchor" href="#arg-percentage-identity"></a></dt>
<dd><p>Not a very sensitive or reliable measure of
sequence similarity, however it is a reasonable proxy for evolutionary
distance. The evolutionary distance associated with a 10 percent change in
Percentage_identity is much greater at longer distances. Thus, a change from
80 – 70 percent identity might reflect divergence 200 million years earlier
in time, but the change from 30 percent to 20 percent might correspond to a
billion year divergence time change [default 70].</p></dd>


<dt id="arg-percentage-overlap">Percentage_overlap<a class="anchor" aria-label="anchor" href="#arg-percentage-overlap"></a></dt>
<dd><p>Calculated as alignment length divided by the
query length or subject length (whichever is shortest of the two lengths,
i.e.  length / min(qlen,slen) ) [default 0.8].</p></dd>


<dt id="arg-bitscore">bitscore<a class="anchor" aria-label="anchor" href="#arg-bitscore"></a></dt>
<dd><p>A rule-of-thumb for inferring homology, a bit score of 50
is almost always significant [default 50].</p></dd>


<dt id="arg-number-of-threads">number_of_threads<a class="anchor" aria-label="anchor" href="#arg-number-of-threads"></a></dt>
<dd><p>Number of threads (CPUs) to use in blastn search
[default 2].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>verbose= 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity]</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If the input is a genlight object: returns a genlight object with one
 hit per sequence merged to the slot $other$loc.metrics. If the input is a
 fasta file: returns a dataframe with one hit per sequence.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Installing BLAST</strong></p>
<p>You can download the BLAST installs from:
 <a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/" class="external-link">https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/</a></p>
<p>It is important to install BLAST in a path that does not contain spaces for
 this function to work.</p>
<p><strong>Running BLAST</strong></p>
<p>Four different tasks are supported:</p><ul><li><p>“megablast”, for very
 similar sequences (e.g, sequencing errors)</p></li>
<li><p>“dc-megablast”, typically
 used for inter-species comparisons</p></li>
<li><p>“blastn”, the traditional program
 used for inter-species comparisons</p></li>
<li><p>“blastn-short”, optimized for
 sequences less than 30 nucleotides</p></li>
</ul><p>If  you  are  running  a  BLAST alignment of  similar  sequences,  for
 example  Turtle  Genome  Vs Turtle Sequences, the recommended parameters
 are: task = “megablast”, Percentage_identity = 70, Percentage_overlap =  0.8
 and bitscore = 50.</p>
<p>If you are running a BLAST alignment of highly dissimilar sequences because
 you are probably looking for sex linked  hits in  a distantly  related
 species,  and  you  are aligning for example sequences of Chicken Genome Vs
 Bassiana, the recommended parameters are: task = “dc-megablast”,
 Percentage_identity = 50, Percentage_overlap =  0.01 and bitscore = 30.</p>
<p>Be aware that running BLAST might take a long time (i.e. days) depending of
 the size of your query, the size of your database and the number of threads
 selected for your computer.</p>
<p><strong>BLAST output</strong></p>
<p>The BLAST output is formatted as a table using output format 6, with columns
 defined in the following order:</p><ul><li><p>qseqid - Query Seq-id</p></li>
<li><p>sacc - Subject accession</p></li>
<li><p>stitle - Subject Title</p></li>
<li><p>qseq - Aligned
 part of query sequence</p></li>
<li><p>sseq - Aligned part of subject sequence</p></li>
<li><p>nident - Number of identical matches</p></li>
<li><p>mismatch - Number of mismatches</p></li>
<li><p>pident - Percentage of identical matches</p></li>
<li><p>length - Alignment
 length</p></li>
<li><p>evalue - Expect value</p></li>
<li><p>bitscore - Bit score</p></li>
<li><p>qstart -
 Start of alignment in query</p></li>
<li><p>qend - End of alignment in query</p></li>
<li><p>sstart - Start of alignment in subject</p></li>
<li><p>send - End of alignment in
 subject</p></li>
<li><p>gapopen - Number of gap openings</p></li>
<li><p>gaps - Total number of
 gaps</p></li>
<li><p>qlen - Query sequence length</p></li>
<li><p>slen - Subject sequence length</p></li>
<li><p>PercentageOverlap - length / min(qlen,slen)</p></li>
</ul><p>Databases containing unfiltered aligned sequences, filtered aligned
 sequences and one hit per sequence are saved to the temporal directory
 (tempdir) and can be accessed with the function
 <code><a href="gl.print.reports.html">gl.print.reports</a></code> and listed with the function
 <code><a href="gl.list.reports.html">gl.list.reports</a></code>. Note that they can be accessed only in the
 current R session because tempdir is cleared each time that the R session is
 closed.</p>
<p><strong>BLAST filtering</strong></p>
<p>BLAST output is filtered by ordering the hits of each sequence first by the
 highest percentage identity, then the highest percentage overlap and then
 the highest bitscore. Only one hit per sequence is kept based on these
 selection criteria.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Altschul, S. F., Gish, W., Miller, W., Myers, E. W., &amp; Lipman, D.
 J. (1990). Basic local alignment search tool. Journal of molecular biology,
 215(3), 403-410.</p></li>
<li><p>Altschul, S. F., Madden, T. L., Schäffer, A. A., Zhang, J., Zhang,
 Z., Miller, W., &amp; Lipman, D. J. (1997). Gapped BLAST and PSI-BLAST: a new
 generation of protein database search programs. Nucleic acids research,
 25(17), 3389-3402.</p></li>
<li><p>Pearson, W. R. (2013). An introduction to sequence similarity
 (“homology”) searching. Current protocols in bioinformatics, 42(1), 3-1.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gl.print.history.html">gl.print.history</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Berenice Talamantes Becerra &amp; Luis Mijangos (Post to
 <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.blast</span><span class="op">(</span>x<span class="op">=</span> <span class="va">testset.gl</span>,ref_genome <span class="op">=</span> <span class="st">'sequence.fasta'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># display of reports saved in the temporal directory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.list.reports.html">gl.list.reports</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># open the reports saved in the temporal directory</span></span></span>
<span class="r-in"><span><span class="va">blast_databases</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.print.reports.html">gl.print.reports</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

