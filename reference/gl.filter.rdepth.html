<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filters loci based on counts of sequence tags scored at a locus (read depth) — gl.filter.rdepth • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filters loci based on counts of sequence tags scored at a locus (read depth) — gl.filter.rdepth"><meta name="description" content="SNP datasets generated by DArT report AvgCountRef and AvgCountSnp as counts
of sequence tags for the reference and alternate alleles respectively. These
can be used to back calculate Read Depth. Fragment presence/absence datasets
as provided by DArT (SilicoDArT) provide Average Read Depth and Standard
 Deviation of Read Depth as standard columns in their report.
Filtering on Read Depth using the companion script gl.filter.rdepth can be on
 the basis of loci with exceptionally low counts,
or loci with exceptionally high counts."><meta property="og:description" content="SNP datasets generated by DArT report AvgCountRef and AvgCountSnp as counts
of sequence tags for the reference and alternate alleles respectively. These
can be used to back calculate Read Depth. Fragment presence/absence datasets
as provided by DArT (SilicoDArT) provide Average Read Depth and Standard
 Deviation of Read Depth as standard columns in their report.
Filtering on Read Depth using the companion script gl.filter.rdepth can be on
 the basis of loci with exceptionally low counts,
or loci with exceptionally high counts."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/green-striped-gecko/dartR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filters loci based on counts of sequence tags scored at a locus (read depth)</h1>
      <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.filter.rdepth.r" class="external-link"><code>R/gl.filter.rdepth.r</code></a></small>
      <div class="d-none name"><code>gl.filter.rdepth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>SNP datasets generated by DArT report AvgCountRef and AvgCountSnp as counts
of sequence tags for the reference and alternate alleles respectively. These
can be used to back calculate Read Depth. Fragment presence/absence datasets
as provided by DArT (SilicoDArT) provide Average Read Depth and Standard
 Deviation of Read Depth as standard columns in their report.</p>
<p>Filtering on Read Depth using the companion script gl.filter.rdepth can be on
 the basis of loci with exceptionally low counts,
or loci with exceptionally high counts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.filter.rdepth</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  lower <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_theme <span class="op">=</span> <span class="fu"><a href="theme_dartR.html">theme_dartR</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plot_colors <span class="op">=</span> <span class="va">two_colors</span>,</span>
<span>  save2tmp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Name of the genlight object containing the SNP or tag
presence/absence data [required].</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Lower threshold value below which loci will be removed
[default 5].</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Upper threshold value above which loci will be removed
[default 50].</p></dd>


<dt id="arg-plot-out">plot.out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>Specify if plot is to be produced [default TRUE].</p></dd>


<dt id="arg-plot-theme">plot_theme<a class="anchor" aria-label="anchor" href="#arg-plot-theme"></a></dt>
<dd><p>Theme for the plot. See Details for options
[default theme_dartR()].</p></dd>


<dt id="arg-plot-colors">plot_colors<a class="anchor" aria-label="anchor" href="#arg-plot-colors"></a></dt>
<dd><p>List of two color names for the borders and fill of the
plots [default two_colors].</p></dd>


<dt id="arg-save-tmp">save2tmp<a class="anchor" aria-label="anchor" href="#arg-save-tmp"></a></dt>
<dd><p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
 [default 2, unless specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a genlight object retaining loci with a Read Depth in the
range specified by the lower and upper threshold.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For examples of themes, see:</p><ul><li><p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and</p></li>
<li><p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="external-link">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>gl.filter.rdepth</code></p>
<p>Other filter functions:
<code><a href="gl.filter.allna.html">gl.filter.allna</a>()</code>,
<code><a href="gl.filter.callrate.html">gl.filter.callrate</a>()</code>,
<code><a href="gl.filter.heterozygosity.html">gl.filter.heterozygosity</a>()</code>,
<code><a href="gl.filter.hwe.html">gl.filter.hwe</a>()</code>,
<code><a href="gl.filter.ld.html">gl.filter.ld</a>()</code>,
<code><a href="gl.filter.locmetric.html">gl.filter.locmetric</a>()</code>,
<code><a href="gl.filter.maf.html">gl.filter.maf</a>()</code>,
<code><a href="gl.filter.monomorphs.html">gl.filter.monomorphs</a>()</code>,
<code><a href="gl.filter.overshoot.html">gl.filter.overshoot</a>()</code>,
<code><a href="gl.filter.pa.html">gl.filter.pa</a>()</code>,
<code><a href="gl.filter.parent.offspring.html">gl.filter.parent.offspring</a>()</code>,
<code><a href="gl.filter.reproducibility.html">gl.filter.reproducibility</a>()</code>,
<code><a href="gl.filter.secondaries.html">gl.filter.secondaries</a>()</code>,
<code><a href="gl.filter.sexlinked.html">gl.filter.sexlinked</a>()</code>,
<code><a href="gl.filter.taglength.html">gl.filter.taglength</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Custodian: Arthur Georges (Post to
<a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># SNP data</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gl.report.rdepth.html">gl.report.rdepth</a></span><span class="op">(</span><span class="va">testset.gl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.report.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Reporting Read Depth by Locus</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   No. of loci = 255 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   No. of individuals = 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Minimum      :  3.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1st quartile :  6.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Median       :  9.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Mean         :  16.60392 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3r quartile  :  22.75 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Maximum      :  66.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Missing Rate Overall:  0.12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.filter.rdepth-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Quantile Threshold Retained Percent Filtered Percent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      100%      66.4        1     0.4      254    99.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       95%      50.7       13     5.1      242    94.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       90%      41.0       26    10.2      229    89.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       85%      34.2       39    15.3      216    84.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       80%      28.9       52    20.4      203    79.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       75%      23.0       64    25.1      191    74.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       70%      20.0       77    30.2      178    69.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       65%      16.2       90    35.3      165    64.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       60%      12.1      102    40.0      153    60.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      55%      10.8      116    45.5      139    54.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      50%       9.5      129    50.6      126    49.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      45%       8.1      143    56.1      112    43.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      40%       7.5      157    61.6       98    38.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      35%       7.0      167    65.5       88    34.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      30%       6.5      182    71.4       73    28.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      25%       6.3      192    75.3       63    24.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      20%       5.6      205    80.4       50    19.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      15%       4.9      217    85.1       38    14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      10%       4.4      232    91.0       23     9.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       5%       4.2      244    95.7       11     4.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21       0%       3.1      255   100.0        0     0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.report.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">gl.filter.rdepth</span><span class="op">(</span><span class="va">testset.gl</span>, lower<span class="op">=</span><span class="fl">8</span>, upper<span class="op">=</span><span class="fl">50</span>, verbose<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Removing loci with rdepth &lt;= 8 and &gt;= 50 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.filter.rdepth-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Summary of filtered dataset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Initial no. of loci = 255 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci deleted = 122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci retained: 133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of individuals: 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of populations:  30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Tag P/A data</span></span></span>
<span class="r-in"><span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">gl.filter.rdepth</span><span class="op">(</span><span class="va">testset.gs</span>, lower<span class="op">=</span><span class="fl">8</span>, upper<span class="op">=</span><span class="fl">50</span>, verbose<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with Presence/Absence (SilicoDArT) data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Removing loci with rdepth &lt;= 8 and &gt;= 50 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.filter.rdepth-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Summary of filtered dataset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Initial no. of loci = 255 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci deleted = 35 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci retained: 220 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of individuals: 218 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of populations:  29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.filter.rdepth</span><span class="op">(</span><span class="va">platypus.gl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: data include loci that are scored NA across all individuals.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Consider filtering using gl &lt;- gl.filter.allna(gl)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Removing loci with rdepth &lt;= 5 and &gt;= 50 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.filter.rdepth-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.filter.rdepth </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

