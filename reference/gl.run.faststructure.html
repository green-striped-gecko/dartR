<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Runs a faststructure analysis using a genlight object — gl.run.faststructure • dartR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Runs a faststructure analysis using a genlight object — gl.run.faststructure"><meta property="og:description" content="This function takes a genlight object and runs a faststructure analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9.9.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dartRTutorials.html">dartR Tutorials</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/green-striped-gecko/dartR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs a faststructure analysis using a genlight object</h1>
    <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.run.faststructure.r" class="external-link"><code>R/gl.run.faststructure.r</code></a></small>
    <div class="hidden name"><code>gl.run.faststructure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a genlight object and runs a faststructure analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.run.faststructure</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">k.range</span>,</span>
<span>  <span class="va">num.k.rep</span>,</span>
<span>  exec <span class="op">=</span> <span class="st">"./fastStructure"</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  cv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Name of the genlight object containing the SNP data [required].</p></dd>


<dt id="arg-k-range">k.range<a class="anchor" aria-label="anchor" href="#arg-k-range"></a></dt>
<dd><p>Range of the number of populations [required].</p></dd>


<dt id="arg-num-k-rep">num.k.rep<a class="anchor" aria-label="anchor" href="#arg-num-k-rep"></a></dt>
<dd><p>Number of replicates [required].</p></dd>


<dt id="arg-exec">exec<a class="anchor" aria-label="anchor" href="#arg-exec"></a></dt>
<dd><p>Full path and name+extension where the fastStructure executable
is located [default working directory "./fastStructure"].</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Path to output file [default getwd()].</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Convergence criterion [default 10e-6].</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Choice of prior: simple or logistic [default "simple"].</p></dd>


<dt id="arg-cv">cv<a class="anchor" aria-label="anchor" href="#arg-cv"></a></dt>
<dd><p>Number of test sets for cross-validation, 0 implies no CV step
[default 0].</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Seed for random number generator [default NULL].</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list in which each list entry is a single faststructure run output
(there are k.range * num.k.rep number of runs).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Download faststructure binary for your system from here (only runs on Mac or
Linux):</p>
<p>https://github.com/StuntsPT/Structure_threader/tree/master/structure_threader/bins</p>
<p>Move faststructure file to working directory. Make file executable using
terminal app.</p>
<p><code>system(paste0("chmod u+x ",getwd(), "/faststructure"))</code></p>
<p>Download plink binary for your system from here:</p>
<p>https://www.cog-genomics.org/plink/</p>
<p>Move plink file to working directory. Make file executable using
terminal app.</p>
<p><code>system(paste0("chmod u+x ",getwd(), "/plink"))</code></p>
<p>To install fastStructure dependencies follow these directions:
https://github.com/rajanil/fastStructure</p>
<p>fastStructure performs inference for the simplest, independent-loci,
admixture model, with two choices of priors that can be specified using
the –prior parameter. Thus, unlike Structure, fastStructure does not require
the mainparams and extraparam files. The inference algorithm used by
 fastStructure is fundamentally different from that of Structure and
 requires the setting of far fewer options.</p>
<p>To identify the number of populations that best approximates the marginal
 likelihood of the data, the marginal likelihood is extracted from each run
 of K, averaged across replications and plotted.</p>
    </div>
    <div id="references">
    <h2>References</h2>

<ul><li><p>Raj, A., Stephens, M., &amp; Pritchard, J. K. (2014). fastSTRUCTURE:
variational inference of population structure in large SNP data sets.
Genetics, 197(2), 573-589.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Luis Mijangos (Post to <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.filter.callrate.html">gl.filter.callrate</a></span><span class="op">(</span><span class="va">platypus.gl</span>,threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gl.run.faststructure</span><span class="op">(</span><span class="va">t1</span>, exec <span class="op">=</span> <span class="st">"./fastStructure"</span>,k.range <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, </span></span>
<span class="r-in"><span>                          num.k.rep <span class="op">=</span> <span class="fl">2</span>,output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/res_str"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.plot.faststructure.html">gl.plot.faststructure</a></span><span class="op">(</span><span class="va">res</span>,k.range<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gl.map.structure.html">gl.map.structure</a></span><span class="op">(</span><span class="va">qmat</span>, K<span class="op">=</span><span class="fl">2</span>, <span class="va">t1</span>, scalex<span class="op">=</span><span class="fl">1</span>, scaley<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

