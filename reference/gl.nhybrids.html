<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Creates an input file for the program NewHybrids and runs it if NewHybrids is installed — gl.nhybrids • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates an input file for the program NewHybrids and runs it if NewHybrids is installed — gl.nhybrids"><meta name="description" content="This function compares two sets of parental populations to identify loci that
exhibit a fixed difference, returns an genlight object with the reduced
data, and creates an input file for the program NewHybrids using the top 200
(or hard specified loc.limit) loci. In the absence of two identified
parental populations, the script will select a random set 200 loci only
(method='random') or the first 200 loci ranked on information content
(method='AvgPIC').
A fixed difference occurs when a SNP allele is present in all individuals
of one population and absent in the other. There is provision for setting
a level of tolerance, e.g. threshold = 0.05 which considers alleles present
at greater than 95
a fixed difference. Only the 200 loci are retained, because of limitations
of NewHybids.
If you specify a directory for the NewHybrids executable file, then the
script will create the input file from the SNP data then run NewHybrids. If
the directory is set to NULL, the execution will stop once the input file
(default='nhyb.txt') has been written to disk. Note: the executable option
will not work on a Mac; Mac users should generate the NewHybrids input file
and run this on their local installation of NewHybrids.
Refer to the New Hybrids manual for further information on the parameters to
set
– http://ib.berkeley.edu/labs/slatkin/eriq/software/new_hybs_doc1_1Beta3.pdf
It is important to stringently filter the data on RepAvg and CallRate if
using the random option. One might elect to repeat the analysis
(method='random') and combine the resultant posterior probabilities should
200 loci be considered insufficient.
The F1 individuals should be homozygous at all loci for which the parental
populations are fixed and different, assuming parental populations have been
specified. Sampling errors can result in this not being the case, especially
where the sample sizes for the parental populations are small. Alternatively,
the threshold for posterior probabilities used to determine assignment
(pprob) or the definition of a fixed difference (threshold) may be too lax.
To assess the error rate in the determination of assignment of F1
individuals, a plot of the frequency of homozygous reference, heterozygotes
and homozygous alternate (SNP) can be produced by setting plot=TRUE (the
default)."><meta property="og:description" content="This function compares two sets of parental populations to identify loci that
exhibit a fixed difference, returns an genlight object with the reduced
data, and creates an input file for the program NewHybrids using the top 200
(or hard specified loc.limit) loci. In the absence of two identified
parental populations, the script will select a random set 200 loci only
(method='random') or the first 200 loci ranked on information content
(method='AvgPIC').
A fixed difference occurs when a SNP allele is present in all individuals
of one population and absent in the other. There is provision for setting
a level of tolerance, e.g. threshold = 0.05 which considers alleles present
at greater than 95
a fixed difference. Only the 200 loci are retained, because of limitations
of NewHybids.
If you specify a directory for the NewHybrids executable file, then the
script will create the input file from the SNP data then run NewHybrids. If
the directory is set to NULL, the execution will stop once the input file
(default='nhyb.txt') has been written to disk. Note: the executable option
will not work on a Mac; Mac users should generate the NewHybrids input file
and run this on their local installation of NewHybrids.
Refer to the New Hybrids manual for further information on the parameters to
set
– http://ib.berkeley.edu/labs/slatkin/eriq/software/new_hybs_doc1_1Beta3.pdf
It is important to stringently filter the data on RepAvg and CallRate if
using the random option. One might elect to repeat the analysis
(method='random') and combine the resultant posterior probabilities should
200 loci be considered insufficient.
The F1 individuals should be homozygous at all loci for which the parental
populations are fixed and different, assuming parental populations have been
specified. Sampling errors can result in this not being the case, especially
where the sample sizes for the parental populations are small. Alternatively,
the threshold for posterior probabilities used to determine assignment
(pprob) or the definition of a fixed difference (threshold) may be too lax.
To assess the error rate in the determination of assignment of F1
individuals, a plot of the frequency of homozygous reference, heterozygotes
and homozygous alternate (SNP) can be produced by setting plot=TRUE (the
default)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/green-striped-gecko/dartR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creates an input file for the program NewHybrids and runs it if NewHybrids is installed</h1>
      <small class="dont-index">Source: <a href="https://github.com/green-striped-gecko/dartR/blob/master/R/gl.nhybrids.r" class="external-link"><code>R/gl.nhybrids.r</code></a></small>
      <div class="d-none name"><code>gl.nhybrids.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function compares two sets of parental populations to identify loci that
exhibit a fixed difference, returns an genlight object with the reduced
data, and creates an input file for the program NewHybrids using the top 200
(or hard specified loc.limit) loci. In the absence of two identified
parental populations, the script will select a random set 200 loci only
(method='random') or the first 200 loci ranked on information content
(method='AvgPIC').</p>
<p>A fixed difference occurs when a SNP allele is present in all individuals
of one population and absent in the other. There is provision for setting
a level of tolerance, e.g. threshold = 0.05 which considers alleles present
at greater than 95<!-- % in one population and less than 5% in the other to be -->
a fixed difference. Only the 200 loci are retained, because of limitations
of NewHybids.</p>
<p>If you specify a directory for the NewHybrids executable file, then the
script will create the input file from the SNP data then run NewHybrids. If
the directory is set to NULL, the execution will stop once the input file
(default='nhyb.txt') has been written to disk. Note: the executable option
will not work on a Mac; Mac users should generate the NewHybrids input file
and run this on their local installation of NewHybrids.</p>
<p>Refer to the New Hybrids manual for further information on the parameters to
set
– http://ib.berkeley.edu/labs/slatkin/eriq/software/new_hybs_doc1_1Beta3.pdf</p>
<p>It is important to stringently filter the data on RepAvg and CallRate if
using the random option. One might elect to repeat the analysis
(method='random') and combine the resultant posterior probabilities should
200 loci be considered insufficient.</p>
<p>The F1 individuals should be homozygous at all loci for which the parental
populations are fixed and different, assuming parental populations have been
specified. Sampling errors can result in this not being the case, especially
where the sample sizes for the parental populations are small. Alternatively,
the threshold for posterior probabilities used to determine assignment
(pprob) or the definition of a fixed difference (threshold) may be too lax.
To assess the error rate in the determination of assignment of F1
individuals, a plot of the frequency of homozygous reference, heterozygotes
and homozygous alternate (SNP) can be produced by setting plot=TRUE (the
default).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gl.nhybrids</span><span class="op">(</span></span>
<span>  <span class="va">gl</span>,</span>
<span>  outpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  p0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_theme <span class="op">=</span> <span class="fu"><a href="theme_dartR.html">theme_dartR</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plot_colors <span class="op">=</span> <span class="va">two_colors</span>,</span>
<span>  pprob <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  nhyb.directory <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  BurnIn <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  sweeps <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  GtypFile <span class="op">=</span> <span class="st">"TwoGensGtypFreq.txt"</span>,</span>
<span>  AFPriorFile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PiPrior <span class="op">=</span> <span class="st">"Jeffreys"</span>,</span>
<span>  ThetaPrior <span class="op">=</span> <span class="st">"Jeffreys"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gl">gl<a class="anchor" aria-label="anchor" href="#arg-gl"></a></dt>
<dd><p>Name of the genlight object containing the SNP data [required].</p></dd>


<dt id="arg-outpath">outpath<a class="anchor" aria-label="anchor" href="#arg-outpath"></a></dt>
<dd><p>Path where to save the output file [default tempdir()].</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>List of populations to be regarded as parental population 0
[default NULL].</p></dd>


<dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>List of populations to be regarded as parental population 1
[default NULL].</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Sets the level at which a gene frequency difference is
considered to be fixed [default 0].</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Specifies the method (random or AvgPIC) to select 200 loci for
NewHybrids [default random].</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>If TRUE, a plot of the frequency of homozygous reference,
heterozygotes and homozygous alternate (SNP) is produced for the F1
individuals
[default TRUE, applies only if both parental populations are specified].</p></dd>


<dt id="arg-plot-theme">plot_theme<a class="anchor" aria-label="anchor" href="#arg-plot-theme"></a></dt>
<dd><p>User specified theme [default theme_dartR()].</p></dd>


<dt id="arg-plot-colors">plot_colors<a class="anchor" aria-label="anchor" href="#arg-plot-colors"></a></dt>
<dd><p>Vector with two color names for the borders and fill
[default two_colors].</p></dd>


<dt id="arg-pprob">pprob<a class="anchor" aria-label="anchor" href="#arg-pprob"></a></dt>
<dd><p>Threshold level for assignment to likelihood bins
[default 0.95, used only if plot=TRUE].</p></dd>


<dt id="arg-nhyb-directory">nhyb.directory<a class="anchor" aria-label="anchor" href="#arg-nhyb-directory"></a></dt>
<dd><p>Directory that holds the NewHybrids executable file
e.g. C:/NewHybsPC [default NULL].</p></dd>


<dt id="arg-burnin">BurnIn<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>Number of sweeps to use in the burn in [default 10000].</p></dd>


<dt id="arg-sweeps">sweeps<a class="anchor" aria-label="anchor" href="#arg-sweeps"></a></dt>
<dd><p>Number  of  sweeps  to  use  in  computing  the  actual Monte
Carlo averages [default 10000].</p></dd>


<dt id="arg-gtypfile">GtypFile<a class="anchor" aria-label="anchor" href="#arg-gtypfile"></a></dt>
<dd><p>Name of a file containing the genotype frequency classes
[default TwoGensGtypFreq.txt].</p></dd>


<dt id="arg-afpriorfile">AFPriorFile<a class="anchor" aria-label="anchor" href="#arg-afpriorfile"></a></dt>
<dd><p>Name of the file containing prior allele frequency
information [default NULL].</p></dd>


<dt id="arg-piprior">PiPrior<a class="anchor" aria-label="anchor" href="#arg-piprior"></a></dt>
<dd><p>Jeffreys-like priors or Uniform priors for the parameter pi
[default Jeffreys].</p></dd>


<dt id="arg-thetaprior">ThetaPrior<a class="anchor" aria-label="anchor" href="#arg-thetaprior"></a></dt>
<dd><p>Jeffreys-like priors or Uniform priors for the parameter
theta [default Jeffreys].</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The reduced genlight object, if parentals are provided; output of
 NewHybrids is saved to the working directory.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, E.C. and Thompson, E.A.(2002). A model-based method for identifying
species hybrids using multilocus genetic data. Genetics. 160:1217-1229.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Custodian: Arthur Georges – Post to
 <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">gl.nhybrids</span><span class="op">(</span><span class="va">testset.gl</span>, </span></span>
<span class="r-in"><span>p0<span class="op">=</span><span class="cn">NULL</span>, p1<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>nhyb.directory<span class="op">=</span><span class="st">'D:/workspace/R/NewHybsPC'</span>, <span class="co"># Specify as necessary</span></span></span>
<span class="r-in"><span>outpath<span class="op">=</span><span class="st">"D:/workspace"</span>,  <span class="co"># Specify as necessary, usually getwd() [= workspace]</span></span></span>
<span class="r-in"><span>BurnIn<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>sweeps<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>verbose<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni, Diana Robledo-Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

