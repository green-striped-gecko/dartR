<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Hamming distance is calculated as the number of base differences
between two sequences which can be expressed as a count or a proportion.
Typically, it is calculated between two sequences of equal length. In the
context of DArT trimmed sequences, which differ in length but which are
anchored to the left by the restriction enzyme recognition sequence, it is
sensible to compare the two trimmed sequences starting from immediately after
the common recognition sequence and terminating at the last base of the
shorter sequence."><title>Calculates the pairwise Hamming distance between DArT trimmed DNA
sequences — gl.report.hamming • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates the pairwise Hamming distance between DArT trimmed DNA
sequences — gl.report.hamming"><meta property="og:description" content="Hamming distance is calculated as the number of base differences
between two sequences which can be expressed as a count or a proportion.
Typically, it is calculated between two sequences of equal length. In the
context of DArT trimmed sequences, which differ in length but which are
anchored to the left by the restriction enzyme recognition sequence, it is
sensible to compare the two trimmed sequences starting from immediately after
the common recognition sequence and terminating at the last base of the
shorter sequence."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculates the pairwise Hamming distance between DArT trimmed DNA
sequences</h1>
      
      <div class="d-none name"><code>gl.report.hamming.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Hamming distance is calculated as the number of base differences
between two sequences which can be expressed as a count or a proportion.
Typically, it is calculated between two sequences of equal length. In the
context of DArT trimmed sequences, which differ in length but which are
anchored to the left by the restriction enzyme recognition sequence, it is
sensible to compare the two trimmed sequences starting from immediately after
the common recognition sequence and terminating at the last base of the
shorter sequence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gl.report.hamming</span><span class="op">(</span>
  <span class="va">x</span>,
  rs <span class="op">=</span> <span class="fl">5</span>,
  threshold <span class="op">=</span> <span class="fl">3</span>,
  taglength <span class="op">=</span> <span class="fl">69</span>,
  plot.out <span class="op">=</span> <span class="cn">TRUE</span>,
  plot_theme <span class="op">=</span> <span class="fu"><a href="theme_dartR.html">theme_dartR</a></span><span class="op">(</span><span class="op">)</span>,
  plot_colors <span class="op">=</span> <span class="va">two_colors</span>,
  probar <span class="op">=</span> <span class="cn">FALSE</span>,
  save2tmp <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Name of the genlight object containing the SNP data [required].</p></dd>
<dt>rs</dt>
<dd><p>Number of bases in the restriction enzyme recognition sequence
[default 5].</p></dd>
<dt>threshold</dt>
<dd><p>Minimum acceptable base pair difference for display on the
boxplot and histogram [default 3].</p></dd>
<dt>taglength</dt>
<dd><p>Typical length of the sequence tags [default 69].</p></dd>
<dt>plot.out</dt>
<dd><p>Specify if plot is to be produced [default TRUE].</p></dd>
<dt>plot_theme</dt>
<dd><p>Theme for the plot. See Details for options
[default theme_dartR()].</p></dd>
<dt>plot_colors</dt>
<dd><p>List of two color names for the borders and fill of the
plots [default two_colors].</p></dd>
<dt>probar</dt>
<dd><p>If TRUE, then a progress bar is displayed on long loops
[default TRUE].</p></dd>
<dt>save2tmp</dt>
<dd><p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p></dd>
<dt>verbose</dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2, unless specified using gl.set.verbosity].</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns unaltered genlight object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code><a href="gl.filter.hamming.html">gl.filter.hamming</a></code> will filter out one of
two loci if their Hamming distance is less than a specified percentage</p>
<p>Hamming distance can be computed by exploiting the fact that the dot product
of two binary vectors x and (1-y) counts the corresponding elements that are
different between x and y. This approach can also be used for vectors that
contain more than two possible values at each position (e.g. A, C, T or G).</p>
<p>If a pair of DNA sequences are of differing length, the longer is truncated.</p>
<p>The algorithm is that of Johann de Jong
<a href="https://johanndejong.wordpress.com/2015/10/02/faster-hamming-distance-in-r-2/" class="external-link">https://johanndejong.wordpress.com/2015/10/02/faster-hamming-distance-in-r-2/</a>
as implemented in <code><a href="utils.hamming.html">utils.hamming</a></code></p>
<p>Plots and table are saved to the session's temporary directory (tempdir)</p>
<p>Examples of other themes that can be used can be consulted in</p><ul><li><p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and</p></li>
<li><p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="external-link">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gl.filter.hamming.html">gl.filter.hamming</a></code></p>
<p>Other filters and filter reports: 
<code><a href="gl.filter.allna.html">gl.filter.allna</a>()</code>,
<code><a href="gl.filter.monomorphs.html">gl.filter.monomorphs</a>()</code>,
<code><a href="gl.filter.rdepth.html">gl.filter.rdepth</a>()</code>,
<code><a href="gl.filter.reproducibility.html">gl.filter.reproducibility</a>()</code>,
<code><a href="gl.filter.secondaries.html">gl.filter.secondaries</a>()</code>,
<code><a href="gl.report.callrate.html">gl.report.callrate</a>()</code>,
<code><a href="gl.report.locmetric.html">gl.report.locmetric</a>()</code>,
<code><a href="gl.report.monomorphs.html">gl.report.monomorphs</a>()</code>,
<code><a href="gl.report.rdepth.html">gl.report.rdepth</a>()</code>,
<code><a href="gl.report.reproducibility.html">gl.report.reproducibility</a>()</code>,
<code><a href="gl.report.taglength.html">gl.report.taglength</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Custodian: Arthur Georges -- Post to <a href="https://groups.google.com/d/forum/dartr" class="external-link">https://groups.google.com/d/forum/dartr</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">gl.report.hamming</span><span class="op">(</span><span class="va">testset.gl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.report.hamming </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Calculating pairwise Hamming distances between trimmed Reference sequence tags</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Plotting boxplot and histogram of Hamming distance, showing a threshold of 3 bp [HD 0.05 ]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci = 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of individuals = 250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Minimum Hamming distance:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Maximum Hamming distance:  0.86 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Mean Hamming Distance 0.66+/-0.077 SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of pairs with Hamming Distance less than or equal to 3 base pairs: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.report.hamming-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Quantile Threshold Retained Percent Filtered Percent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      100% 0.8550725        2     0.0     4948   100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       95% 0.7681159      334     6.7     4616    93.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       90% 0.7536232      525    10.6     4425    89.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       85% 0.7391304      864    17.5     4086    82.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       80% 0.7246377     1179    23.8     3771    76.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       75% 0.7200000     1264    25.5     3686    74.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       70% 0.7101449     1567    31.7     3383    68.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       65% 0.6956522     1999    40.4     2951    59.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       60% 0.6956522     1999    40.4     2951    59.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      55% 0.6811594     2381    48.1     2569    51.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      50% 0.6744186     2480    50.1     2470    49.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      45% 0.6666667     2871    58.0     2079    42.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      40% 0.6538462     2971    60.0     1979    40.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      35% 0.6500000     3238    65.4     1712    34.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      30% 0.6376812     3548    71.7     1402    28.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      25% 0.6231884     3767    76.1     1183    23.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      20% 0.6086957     3992    80.6      958    19.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      15% 0.5869565     4209    85.0      741    15.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      10% 0.5652174     4458    90.1      492     9.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       5% 0.5217391     4704    95.0      246     5.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21       0% 0.0000000     4950   100.0        0     0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.report.hamming </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">gl.report.hamming</span><span class="op">(</span><span class="va">testset.gs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.report.hamming </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with Presence/Absence (SilicoDArT) data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Calculating pairwise Hamming distances between trimmed Reference sequence tags</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Plotting boxplot and histogram of Hamming distance, showing a threshold of 3 bp [HD 0.05 ]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of loci = 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of individuals = 218 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Minimum Hamming distance:  0.03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Maximum Hamming distance:  0.86 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Mean Hamming Distance 0.68+/-0.066 SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No. of pairs with Hamming Distance less than or equal to 3 base pairs: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.report.hamming-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Quantile  Threshold Retained Percent Filtered Percent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      100% 0.85714286        1     0.0     4949   100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       95% 0.76811594      318     6.4     4632    93.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       90% 0.75362319      528    10.7     4422    89.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       85% 0.73913043      829    16.7     4121    83.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       80% 0.72463768     1175    23.7     3775    76.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       75% 0.72131148     1244    25.1     3706    74.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       70% 0.71014493     1623    32.8     3327    67.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       65% 0.70270270     1740    35.2     3210    64.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       60% 0.69565217     2102    42.5     2848    57.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      55% 0.68888889     2229    45.0     2721    55.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      50% 0.68115942     2560    51.7     2390    48.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      45% 0.67213115     2740    55.4     2210    44.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      40% 0.66666667     3126    63.2     1824    36.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      35% 0.65573770     3224    65.1     1726    34.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      30% 0.65217391     3490    70.5     1460    29.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      25% 0.63888889     3723    75.2     1227    24.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      20% 0.63265306     3976    80.3      974    19.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      15% 0.61904762     4216    85.2      734    14.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      10% 0.60000000     4469    90.3      481     9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       5% 0.57500000     4705    95.1      245     4.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21       0% 0.02898551     4950   100.0        0     0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.report.hamming </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

