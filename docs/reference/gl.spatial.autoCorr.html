<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Global spatial autocorrelation is a multivariate approach combining all loci
into a single analysis. The autocorrelation coefficient r is calculated for
each pairwise genetic distance pairs for all specified distance classes. For
more information see Smouse and Peakall 1999, Peakall et a. 2003 and Smouse
et al. 2008."><title>Spatial autocorrelation following Smouse and Pekall 1999 — gl.spatial.autoCorr • dartR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial autocorrelation following Smouse and Pekall 1999 — gl.spatial.autoCorr"><meta property="og:description" content="Global spatial autocorrelation is a multivariate approach combining all loci
into a single analysis. The autocorrelation coefficient r is calculated for
each pairwise genetic distance pairs for all specified distance classes. For
more information see Smouse and Peakall 1999, Peakall et a. 2003 and Smouse
et al. 2008."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dartR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dartRTutorials.html">dartR Tutorials</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Spatial autocorrelation following Smouse and Pekall 1999</h1>
      
      <div class="d-none name"><code>gl.spatial.autoCorr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Global spatial autocorrelation is a multivariate approach combining all loci
into a single analysis. The autocorrelation coefficient r is calculated for
each pairwise genetic distance pairs for all specified distance classes. For
more information see Smouse and Peakall 1999, Peakall et a. 2003 and Smouse
et al. 2008.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gl.spatial.autoCorr</span><span class="op">(</span>
  <span class="va">GD</span>,
  <span class="va">GGD</span>,
  bins <span class="op">=</span> <span class="fl">2</span>,
  reps <span class="op">=</span> <span class="fl">100</span>,
  permutation <span class="op">=</span> <span class="cn">FALSE</span>,
  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,
  plot_theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>,
  outpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,
  out_file_rootname <span class="op">=</span> <span class="st">"autoCorr"</span>,
  verbose <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>GD</dt>
<dd><p>a matrix of individual pairwise genetic distances. In principle 
any other squared distance matrix can be used. see example</p></dd>
<dt>GGD</dt>
<dd><p>A geographical distance matrix, based on the coordinates of
individuals. This is typically an Euclidean distance but it can be 
any meaningful (geographical) distance metrics.</p></dd>
<dt>bins</dt>
<dd><p>The number of bins for the distance classes 
(i.e. <code>length(bins) == 1)</code> or a vectors with the break points. See details.</p></dd>
<dt>reps</dt>
<dd><p>The number to be used for permutation and bootstrap analyses</p></dd>
<dt>permutation</dt>
<dd><p>Whether permutation calculations for the null hypothesis of 
no spatial structure should be carried out</p></dd>
<dt>bootstrap</dt>
<dd><p>Whether bootstrap calculations to compute the 95<!-- % confidence intervals  -->
around r should be carried out</p></dd>
<dt>plot_theme</dt>
<dd><p>User specified theme [default theme_dartR()].</p></dd>
<dt>outpath</dt>
<dd><p>The path where to save the output</p></dd>
<dt>out_file_rootname</dt>
<dd><p>The name of the root of the output file</p></dd>
<dt>verbose</dt>
<dd><p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default NULL, unless specified using gl.set.verbosity].</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data frame with the following columns:</p><ol><li><p>Bin  The distance classes</p></li>
<li><p>N The number of pairwise comparisons within each distance class</p></li>
<li><p>r.uc The uncorrected autocorrelation coefficient</p></li>
<li><p>Correction the correction</p></li>
<li><p>r The corrected autocorrelation coefficient</p></li>
<li><p>L.r The corrected autocorrelation coefficient lower limit 
(if <code>bootstap = TRUE</code>)</p></li>
<li><p>U.r The corrected autocorrelation coefficient upper limit 
(if <code>bootstap = TRUE</code>)</p></li>
<li><p>L.r.null.uc The uncorrectedlower limit for the null hypothesis of no spatial 
autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>U.r.null.uc  The uncorrected upper limit for the null hypothesis of no spatial 
autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>L.r.null The corrected lower limit for the null hypothesis of no spatial 
autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>U.r.null The corrected upper limit for the null hypothesis of no spatial 
autocorrelation (if <code>permutation = TRUE</code>)</p></li>
<li><p>p.one.tail The p value of the one tail statistical test</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The code of this function execute behind the scene a modified 
version of <code>spautocorr</code> from the package 
<code>PopGenReport</code>, and it also includes 
bootstraps to compute the 95<!-- % confidence intervals around the r  -->
estimates, the one-tail test, and the correction factor described by 
Peakall et al 2003.</p>
<p>If <code>bins</code> is of length = 1 it is interpreted as the number of (even) 
bins to use. In this case the starting point is always the minimum 
value in the distance matrix, and the last is the maximum. If it is a numeric
vector of length&gt;1, it is interpreted as the breaking points. In this case, 
the first has to be the lowest value, and the last has to be the highest. 
There are no internal checks for this and it is user responsibility to ensure that 
distance classes are properly set up. If that is not the case, data that fall 
outside the range provided will be dropped. The number of 
bins will be  <code>length(bins) - 1</code>.</p>
<p>The permutation constructs the 95<!-- % confidence intervals around the null  -->
hypothesis of no spatial structure (this is a two-tail test). The same data
are also used to calculate the probability of the one-tail test (See reference 
below for details).</p>
<p>Bootstrap calculations are skipped and <code>NA</code> is returned when the number of 
possible combinations given the sample size of any given distance class is 
&lt; <code>reps</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Smouse PE, Peakall R. 1999. Spatial autocorrelation analysis of
individual multiallele and multilocus genetic structure. Heredity 82:
561-573.</p></li>
<li><p>Double, MC, et al. 2005. Dispersal, philopatry and infidelity: dissecting
local genetic structure in superb fairy-wrens (Malurus cyaneus). Evolution
59, 625-635.</p></li>
<li><p>Peakall, R, et al. 2003. Spatial autocorrelation analysis offers new
insights into gene flow in the Australian bush rat, Rattus fuscipes.
Evolution 57, 1182-1195.</p></li>
<li><p>Smouse, PE, et al. 2008. A heterogeneity test for fine-scale genetic
structure. Molecular Ecology 17, 3389-3400.</p></li>
<li><p>Gonzales, E, et al. 2010. The impact of landscape disturbance on spatial
genetic structure in the Guanacaste tree, Enterolobium
cyclocarpum(Fabaceae). Journal of Heredity 101, 133-143.</p></li>
<li><p>Beck, N, et al. 2008. Social constraint and an absence of sex-biased
dispersal drive fine-scale genetic structure in white-winged choughs.
Molecular Ecology 17, 4346-4358.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Carlo Pacioni &amp; Bernd Gruber</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"> <span class="co"># Select one pop only</span></span>
<span class="r-in"><span class="va">plat_Tent</span> <span class="op">&lt;-</span> <span class="fu"><a href="gl.keep.ind.html">gl.keep.ind</a></span><span class="op">(</span><span class="va">platypus.gl</span>, </span>
<span class="r-in">ind.list <span class="op">=</span> <span class="va">platypus.gl</span><span class="op">@</span><span class="va">ind.names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/accessors.html" class="external-link">pop</a></span><span class="op">(</span><span class="va">platypus.gl</span><span class="op">)</span> <span class="op">==</span> <span class="st">"TENTERFIELD"</span><span class="op">]</span>, </span>
<span class="r-in">mono.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.keep.ind </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Warning: data include loci that are scored NA across all individuals.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">  Consider filtering using gl &lt;- gl.filter.allna(gl)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Deleting all but the listed individuals T27, T35, T3, T11, T19, T28, T36, T4, T12, T20, T29, T5, T13, T21, T30, T38, T6, T14, T22, T31, T39, T7, T15, T23, T32, T40, T8, T16, T24, T33, T41, T1, T9, T17, T25, T34, T42, T2, T10, T18, T26 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Deleting monomorphic loc</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Locus metrics not recalculated</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.keep.ind </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># Compute a simple distance matrix and reverse it so that correlated values </span></span>
<span class="r-in"><span class="co"># indicated more similar individuals as we are used to see plots in GenAleEx</span></span>
<span class="r-in"><span class="va">gd</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="gl.dist.ind.html">gl.dist.ind</a></span><span class="op">(</span><span class="va">plat_Tent</span>, method <span class="op">=</span> <span class="st">"Simple"</span>, plot.out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.dist.ind </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Processing genlight object with SNP data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Calculating simple matching distance</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Returning a stat::dist object</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Completed: gl.dist.ind </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># Replace the diagonal with zeros</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span class="r-in"><span class="co"># Compute the geographical distance matrix</span></span>
<span class="r-in"><span class="va">ggd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">plat_Tent</span><span class="op">@</span><span class="va">other</span><span class="op">$</span><span class="va">latlon</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Spatial autocorrelation</span></span>
<span class="r-in"><span class="va">spa</span> <span class="op">&lt;-</span> <span class="fu">gl.spatial.autoCorr</span><span class="op">(</span><span class="va">gd</span>, <span class="va">ggd</span>, bins <span class="op">=</span> <span class="fl">3</span>, reps <span class="op">=</span> <span class="fl">100</span>, </span>
<span class="r-in">permutation <span class="op">=</span> <span class="cn">TRUE</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Starting gl.spatial.autoCorr </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="gl.spatial.autoCorr-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">  Saving outputs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Alternatively, use Smouse distance from PopGneReport package</span></span>
<span class="r-in"><span class="va">smouse.plat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">PopGenReport</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PopGenReport/man/gd.smouse.html" class="external-link">gd.smouse</a></span><span class="op">(</span><span class="fu"><a href="gl2gi.html">gl2gi</a></span><span class="op">(</span><span class="va">plat_Tent</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">spa.sm</span> <span class="op">&lt;-</span> <span class="fu">gl.spatial.autoCorr</span><span class="op">(</span><span class="va">smouse.plat</span>, <span class="va">ggd</span>, bins <span class="op">=</span> <span class="fl">3</span>, reps <span class="op">=</span> <span class="fl">100</span>, </span>
<span class="r-in">permutation <span class="op">=</span> <span class="cn">TRUE</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="co">#' @seealso \code{\link{gl.spatial.ac.multi}}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bernd Gruber, Arthur Georges, Jose L. Mijangos, Carlo Pacioni.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

